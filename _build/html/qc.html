
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Selección y filtro de células y genes basado en métricas de calidad &#8212; Agrupacion</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=87e54e7c" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=3ee479438cf8b5e0d341"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'qc';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Selección de características" href="caracteristicas.html" />
    <link rel="prev" title="Preprocesamiento" href="preprocesamiento.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Agrupacion - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Agrupacion - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Análisis de secuenciación de RNA de célula única utilizando Galaxy
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Primeros Pasos</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="galaxy.html">Introducción al Flujo de Trabajo en Galaxy</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Preprocesamiento</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="AnnData.html">Creación de objeto AnnData</a></li>
<li class="toctree-l1"><a class="reference internal" href="preprocesamiento.html">Preprocesamiento</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Selección y filtro de células y genes basado en métricas de calidad</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Filtrado de datos</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="caracteristicas.html">Selección de características</a></li>
<li class="toctree-l1"><a class="reference internal" href="dimensiones.html">Reducción de dimensiones</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Anotación</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="marcadores.html">Identificación de marcadores</a></li>
<li class="toctree-l1"><a class="reference internal" href="anotacion.html">Anotación de tipos celulares</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/qc.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Selección y filtro de células y genes basado en métricas de calidad</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inspeccion-de-control-de-calidad">11: Inspección de control de calidad</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#anotacion-de-genes-mitocondriales-extraccion-de-genes-presentes-en-el-set-de-datos">12: Anotación de genes mitocondriales: Extracción de genes presentes en el set de datos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#chequeo-de-formato-de-anotacion-de-genes">13: Chequeo de formato de anotación de genes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#formatear-texto-para-detectar-genes-mitocondriales">14: Formatear texto para detectar genes mitocondriales</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cambio-de-formato-de-binario-a-v-f">15: Cambio de formato de binario a V/F</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#concatenar-header-y-clasificacion-de-genes-mitocondriales">16: Concatenar header y clasificación de genes mitocondriales</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#anadir-anotacion-mitocondrial-a-archivo-filtrado">17: Añadir anotación mitocondrial a Archivo filtrado</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inspeccionar-integracion-de-la-anotacion-mitocondrial">18: Inspeccionar integración de la anotación mitocondrial</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#computo-de-metricas-de-control-de-calidad-qc">19: Cómputo de métricas de control de calidad (QC)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#grafico-metricas-generales-de-qc">20: Gráfico: Métricas generales de QC</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#grafico-numero-de-genes-expresados-y-la-proporcion-de-genes-mitocondriales">21: Gráfico: Número de genes expresados y la proporción de genes mitocondriales</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#grafico-numero-de-genes-expresados-por-celula-y-total-de-genes-expresados">22: Gráfico: Número de genes expresados por célula y total de genes expresados</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filtro-eliminar-celulas-con-pocos-genes-expresados">23: Filtro: Eliminar células con pocos genes expresados</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filtro-eliminar-celulas-con-demasiados-genes-expresados">24: Filtro: Eliminar células con demasiados genes expresados</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filtro-eliminar-celulas-con-gran-porcentaje-de-expresion-de-genes-mitocondriales">25: Filtro: Eliminar células con gran porcentaje de expresión de genes mitocondriales</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#normalizacion">26: Normalización</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transformacion-logaritmica">27: Transformación logaritmica</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bloquear-estado-del-archivo-anndata">28: Bloquear estado del archivo Anndata</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="seleccion-y-filtro-de-celulas-y-genes-basado-en-metricas-de-calidad">
<h1>Selección y filtro de células y genes basado en métricas de calidad<a class="headerlink" href="#seleccion-y-filtro-de-celulas-y-genes-basado-en-metricas-de-calidad" title="Link to this heading">#</a></h1>
<p>Para estimar los valores límite (threshold) que debemos usar en los análisis posteriores, primero se debe evaluar la distribución de las métricas de control de calidad para nuestro set de datos.</p>
<p>Las primeras dos métricas que debemos analizar son el tamaño de las células y el número de genes expresados, los pueden ser fácilmente estimadas desde la tabla de cuentas. La tercera métrica es la proporción de lecturas (reads) mapeadas a genes en el genoma mitocondrial, y para esto necesitamos la información sobre qué genes pertenecen a la mitocondria o no.</p>
<p>Para comprender mejor los siguientes pasos, es importante tener en cuenta estas definiciones:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>* **Tamaño de célula: **El número total de cuentas asociadas a una célula determinada. Cuando una célula sufre daños importantes o si la secuenciación de esa célula en particular generó pocas lecturas, se consideran células de baja calidad que podrían alterar los resultados finales. Ambos fenómenos se asocian con un bajo número de lecturas asociadas a la célula, por lo que es mejor eliminarlas del análisis.
* **Número de genes expresados:** Número de genes con cuentas &gt; 0. Un número bajo de genes expresados es otro indicador de daño celular o pérdida de muestra durante el procesamiento de esta. Si el número de genes expresados de una célula es bajo es un indicador de baja calidad para la información de dicha célula y es preferible eliminarla.
* **Proporción de lecturas mapeadas a genes en el genoma mitocondrial:** Altas concentraciones de genes mitocondriales es un indicador común de células dañadas, en donde el RNA endógeno de la célula no fue captado o fue degradado durante el proceso. El RNA mitocondrial estaría con mayor representación en estas muestras dado a que la mitocondria tiene su propia membrana, la cual protegería al RNA con una barrera física extra a las que ya tendría como protección el RNA celular, pudiendo conservarse incluso cuando la célula haya resultado dañada durante los análisis.
</pre></div>
</div>
<p>Cabe destacar, que en este flujo de trabajo se han conservado los valores de corte (threshold) del tutorial que se usó como base, por lo que se debe analizar nuevamente para comprobar que estos valores sean adecuados para el set de datos analizado, y de lo contrario, modificarlos para obtener resultados de alta calidad.</p>
<section id="inspeccion-de-control-de-calidad">
<h2>11: Inspección de control de calidad<a class="headerlink" href="#inspeccion-de-control-de-calidad" title="Link to this heading">#</a></h2>
<p>Se visualiza la información de la abundancia de células por gen expresado.</p>
<p>Resultado esperado:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>	<span class="n">gene_ids</span>	<span class="n">n_cells</span>
<span class="n">AL627309</span><span class="mf">.1</span>	<span class="n">ENSG00000237683</span>	<span class="mi">9</span>
<span class="n">AP006222</span><span class="mf">.2</span>	<span class="n">ENSG00000228463</span>	<span class="mi">3</span>
<span class="n">RP11</span><span class="o">-</span><span class="mi">206</span><span class="n">L10</span><span class="mf">.2</span>	<span class="n">ENSG00000228327</span>	<span class="mi">5</span>
<span class="n">RP11</span><span class="o">-</span><span class="mi">206</span><span class="n">L10</span><span class="mf">.9</span>	<span class="n">ENSG00000237491</span>	<span class="mi">3</span>
</pre></div>
</div>
<p>Utilizar la herramienta “<strong>Inspect AnnData object”</strong> con los siguientes ajustes:</p>
<ul class="simple">
<li><p>_Data input: _’input’ (h5ad) (no manipulable en Flujo de Trabajo; corresponde al Archivo filtrado).</p></li>
<li><p><em>What to inspect?:</em> Key-indexed annotation of variables/features (var)</p></li>
<li><p><em>Configure Output: ‘var’:</em></p>
<ul>
<li><p>_Label: _Archivo – filt - anotado.</p></li>
<li><p>_Rename dataset: _Archivo – filt - anotado.</p></li>
</ul>
</li>
</ul>
<p>Con el archivo resultante se obtiene  la anotación de los genes, que consiste en el <em>gene_symbol</em> y un identificador de la base de datos, en este caso, ENSEMBL.</p>
<p>Para identificar los genes mitocondriales se utilizará el <em>gene_symbol</em>, que también corresponde a la abreviación del nombre del gen, e indica si un gen es mitocondrial utilizando el prefijo “MT-”. Cabe recalcar que esta estrategia se basa en que la anotación del genoma analizado sea de alta calidad.</p>
<p>Para llevar a cabo esto, necesitamos agregar una nueva columna al parámetro “var” del <em>Archivo – filt – anotado.</em> La nueva anotación en “var” será una tabla con el mismo número de líneas que el “var” original y tantas columnas como nuevas anotaciones. En este Flujo de trabajo, la tabla comenzó a crearse con la carga de archivos antes de iniciar la corrida, bajo el nombre <em>Generar header</em>. Este consiste en una tabla que sólo posee el header de la columna, <em>mito</em>. Luego en las filas de esta columna se anotarán los genes que sean mitocondriales o no. Esto lo lograremos llenando la información de cada gen basada en el prefijo del <em>gene_symbol</em>, en donde si un gen posee el prefijo “MT-”, el valor de la fila que corresponda con el gen será “True”, y si no es detectado este prefijo, el valor será “False”.</p>
</section>
<section id="anotacion-de-genes-mitocondriales-extraccion-de-genes-presentes-en-el-set-de-datos">
<h2>12: Anotación de genes mitocondriales: Extracción de genes presentes en el set de datos<a class="headerlink" href="#anotacion-de-genes-mitocondriales-extraccion-de-genes-presentes-en-el-set-de-datos" title="Link to this heading">#</a></h2>
<p>Con este paso se obtendrá la anotación de los genes incluyendo <em>gene_symbol</em>, identificador del gen de la base de datos ENSEMBL (determinado por el archivo inicial <strong>Genes</strong>), y el número de células que expresan cada gen, este último dato no es relevante para este paso, pero es parte de la anotación extraída.</p>
<p>Utilizar la herramienta “<strong>Select last lines from dataset (tail)”</strong> con los siguientes ajustes:</p>
<ul class="simple">
<li><p>_Data input: _’infile’ (txt) (no manipulable en Flujo de Trabajo; corresponde al Archivo – filt - anotado).</p></li>
<li><p><em>Operation:</em> Keep everything from this line on</p></li>
<li><p><em>Number of lines:</em> 2</p></li>
<li><p><em>Configure Output: ‘outfile’:</em></p>
<ul>
<li><p>_Label: _Anotación de genes (base).</p></li>
<li><p>_Rename dataset: _Anotación de genes (base).</p></li>
</ul>
</li>
</ul>
</section>
<section id="chequeo-de-formato-de-anotacion-de-genes">
<h2>13: Chequeo de formato de anotación de genes<a class="headerlink" href="#chequeo-de-formato-de-anotacion-de-genes" title="Link to this heading">#</a></h2>
<p>El _gene_symbol _o nombre de los genes mitocondriales comienzan con un ‘MT-’, lo que nos ayudará a identificarlos. En este control de datos se revisa que esta nomenclatura esté presente en nuestro set de datos.</p>
<p>Utilizar la herramienta “<strong>Search in textfiles (grep)”</strong> con los siguientes ajustes:</p>
<ul class="simple">
<li><p>_Data input: _’infile’ (txt) (no manipulable en Flujo de Trabajo; corresponde al Anotación de genes (base).</p></li>
<li><p><em>that:</em> Match</p></li>
<li><p><em>Type of regex:</em> Perl</p></li>
<li><p><em>Regular Expression:</em> ^mt</p></li>
<li><p><em>Match type:</em> case insensitive</p></li>
<li><p><em>Output:</em> Highlighted HTML (for easier viewing)</p></li>
<li><p><em>Configure Output: ‘output’:</em></p>
<ul>
<li><p><em>Label:</em> Chequeo: match genes mitocondriales.</p></li>
<li><p>_Rename dataset: _Chequeo: match genes mitocondriales.</p></li>
</ul>
</li>
<li><p>Al revisar el resultado, haciendo click en el ícono con forma de ojo en el módulo en la sección de **History **debería mostrar la siguiente información en el panel central:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MTOR</span>	<span class="n">ENSG00000198793</span>	<span class="mi">35</span>
<span class="n">MTHFR</span>	<span class="n">ENSG00000177000</span>	<span class="mi">60</span>
<span class="n">MTFR1L</span>	<span class="n">ENSG00000117640</span>	<span class="mi">136</span>
<span class="n">MTF1</span>	<span class="n">ENSG00000188786</span>	<span class="mi">66</span>
<span class="n">MTF2</span>	<span class="n">ENSG00000143033</span>	<span class="mi">225</span>
<span class="n">MTMR11</span>	<span class="n">ENSG00000014914</span>	<span class="mi">135</span>
<span class="n">MTX1</span>	<span class="n">ENSG00000173171</span>	<span class="mi">136</span>
<span class="n">MTR</span>	<span class="n">ENSG00000116984</span>	<span class="mi">44</span>
<span class="n">MTA3</span>	<span class="n">ENSG00000057935</span>	<span class="mi">36</span>
<span class="n">MTIF2</span>	<span class="n">ENSG00000085760</span>	<span class="mi">68</span>
</pre></div>
</div>
</section>
<section id="formatear-texto-para-detectar-genes-mitocondriales">
<h2>14: Formatear texto para detectar genes mitocondriales<a class="headerlink" href="#formatear-texto-para-detectar-genes-mitocondriales" title="Link to this heading">#</a></h2>
<p>Uso de AWK para generar columna con valores binarios (1 o 0) dependiendo de si el nombre del gen tiene el prefijo ‘MT-’ o no, respectivamente.</p>
<p>Utilizar la herramienta “<strong>Text reformatting with awk”</strong> con los siguientes ajustes:</p>
<ul class="simple">
<li><p>_Data input: _’infile’ (txt) (no manipulable en Flujo de Trabajo; corresponde al Anotación de genes (base)).</p></li>
<li><p><em>AWK Program:</em> {print $1 ~ /^MT-/}</p></li>
<li><p><em>Configure Output: ‘outfile’:</em></p>
<ul>
<li><p><em>Label:</em> Chequeo: Anotación mitocondrial (sin procesar).</p></li>
<li><p>_Rename dataset: _Anotación mitocondrial (sin procesar).</p></li>
</ul>
</li>
</ul>
</section>
<section id="cambio-de-formato-de-binario-a-v-f">
<h2>15: Cambio de formato de binario a V/F<a class="headerlink" href="#cambio-de-formato-de-binario-a-v-f" title="Link to this heading">#</a></h2>
<p>Utilizando reconocimiento de patrones se cambiarán los valores binarios de 1 o 0 asignados previamente a Verdadero o Falso respectivamente.</p>
<p>Utilizar la herramienta “<strong>Replace Text in entire line”</strong> con los siguientes ajustes:</p>
<ul class="simple">
<li><p>_Data input: _’infile’ (txt) (no manipulable en Flujo de Trabajo; corresponde al Anotación mitocondrial (sin procesar)).</p></li>
<li><p><em>1: Replacement</em></p>
<ul>
<li><p><em>Find pattern:</em> 0</p></li>
<li><p><em>Replace with:</em> False</p></li>
</ul>
</li>
<li><p><em>2: Replacement</em></p>
<ul>
<li><p>_Find pattern: _1</p></li>
<li><p><em>Replace with:</em> True</p></li>
</ul>
</li>
<li><p><em>Configure Output: ‘outfile’:</em></p>
<ul>
<li><p><em>Label:</em> Chequeo: Anotación mitocondrial (sin header).</p></li>
<li><p>_Rename dataset: _Anotación mitocondrial (sin header).</p></li>
</ul>
</li>
</ul>
</section>
<section id="concatenar-header-y-clasificacion-de-genes-mitocondriales">
<h2>16: Concatenar header y clasificación de genes mitocondriales<a class="headerlink" href="#concatenar-header-y-clasificacion-de-genes-mitocondriales" title="Link to this heading">#</a></h2>
<p>Se asignará el header subido al inicio del Flujo de Trabajo en <strong>Generar header</strong> a la anotación mitocondrial obtenida en el paso 15.</p>
<p>Utilizar la herramienta “<strong>Concatenate datasets tail-to-head”</strong> con los siguientes ajustes:</p>
<ul class="simple">
<li><p>_Data input: _’input1’ (data) (no manipulable en Flujo de Trabajo; corresponde al Anotación mitocondrial (sin header) y  <strong>Generar header</strong>).</p></li>
<li><p><em>Configure Output: ‘out_file1’:</em></p>
<ul>
<li><p><em>Label:</em> Chequeo: Anotación mitocondrial.</p></li>
<li><p>_Rename dataset: _Anotación mitocondrial.</p></li>
</ul>
</li>
</ul>
</section>
<section id="anadir-anotacion-mitocondrial-a-archivo-filtrado">
<h2>17: Añadir anotación mitocondrial a Archivo filtrado<a class="headerlink" href="#anadir-anotacion-mitocondrial-a-archivo-filtrado" title="Link to this heading">#</a></h2>
<p>Se agregará la anotación mitocondrial como columna de variante al Archivo filtrado.</p>
<p>Utilizar la herramienta “<strong>Manipulate Anndata object”</strong> con los siguientes ajustes:</p>
<ul class="simple">
<li><p>_Data input: _’input’ (h5ad) (no manipulable en Flujo de Trabajo; corresponde al Archivo filtrado).</p></li>
<li><p><em>Function to manipulate the objetct:</em> Add new annotation(s) for observations or variables</p></li>
<li><p><em>What to annotate?</em>: Variables (var)</p></li>
<li><p><em>Table with new annotations:</em> Data input ‘new_annot’ (tabular) (no manipulable en Flujo de Trabajo; corresponde a la Anotación mitocondrial).</p></li>
<li><p><em>Configure Output: ‘anndata’:</em></p>
<ul>
<li><p><em>Label:</em> Chequeo: Archivo – filt - mito.</p></li>
<li><p>_Rename dataset: _Archivo – filt -mito.</p></li>
</ul>
</li>
</ul>
</section>
<section id="inspeccionar-integracion-de-la-anotacion-mitocondrial">
<h2>18: Inspeccionar integración de la anotación mitocondrial<a class="headerlink" href="#inspeccionar-integracion-de-la-anotacion-mitocondrial" title="Link to this heading">#</a></h2>
<p>Resultado esperado:</p>
<table>
  <tr>
   <td><code>Column 1</code>
   </td>
   <td><code>Column 2</code>
   </td>
   <td><code>Column 3</code>
   </td>
   <td><code>Column 4</code>
   </td>
  </tr>
  <tr>
   <td>
   </td>
   <td><code>gene_ids</code>
   </td>
   <td><code>n_cells</code>
   </td>
   <td><code>mito</code>
   </td>
  </tr>
  <tr>
   <td><code>AL627309.1</code>
   </td>
   <td><code>ENSG00000237683</code>
   </td>
   <td><code>9</code>
   </td>
   <td><code>False</code>
   </td>
  </tr>
  <tr>
   <td><code>AP006222.2</code>
   </td>
   <td><code>ENSG00000228463</code>
   </td>
   <td><code>3</code>
   </td>
   <td><code>False</code>
   </td>
  </tr>
  <tr>
   <td><code>RP11-206L10.2</code>
   </td>
   <td><code>ENSG00000228327</code>
   </td>
   <td><code>5</code>
   </td>
   <td><code>False</code>
   </td>
  </tr>
  <tr>
   <td><code>RP11-206L10.9</code>
   </td>
   <td><code>ENSG00000237491</code>
   </td>
   <td><code>3</code>
   </td>
   <td><code>False</code>
   </td>
  </tr>
  <tr>
   <td><code>LINC00115</code>
   </td>
   <td><code>ENSG00000225880</code>
   </td>
   <td><code>18</code>
   </td>
   <td><code>False</code>
   </td>
  </tr>
</table>
<p>Utilizar la herramienta “<strong>Inspect Anndata object”</strong> con los siguientes ajustes:</p>
<ul class="simple">
<li><p>_Data input: _’input1’ (data) (no manipulable en Flujo de Trabajo; corresponde al Archivo – filt - mito).</p></li>
<li><p><em>What to inspect?</em>: Key-indexed annotation of variables/features (var)</p></li>
<li><p><em>Configure Output: ‘var’:</em></p>
<ul>
<li><p><em>Label:</em> Chequeo: Integración de anotación mitocondrial.</p></li>
<li><p>_Rename dataset: _Integración de anotación mitocondrial.</p></li>
</ul>
</li>
</ul>
</section>
<section id="computo-de-metricas-de-control-de-calidad-qc">
<h2>19: Cómputo de métricas de control de calidad (QC)<a class="headerlink" href="#computo-de-metricas-de-control-de-calidad-qc" title="Link to this heading">#</a></h2>
<p>*quality control = QC</p>
<p>Utilizar la herramienta “<strong>Inspect and manipulate with Scanpy”</strong> con los siguientes ajustes:</p>
<ul class="simple">
<li><p>_Data input: _’adata’ (h5ad) (no manipulable en Flujo de Trabajo; corresponde al Archivo – filt - mito).</p></li>
<li><p>_Method used for inspecting: _ Calculate quality control metrics, using ‘pp.calculate_qc_metrics’.</p>
<ul>
<li><p><em>Name of kind of values in X:</em> counts</p></li>
<li><p><em>The kind of thing the variables are:</em> genes</p></li>
<li><p>_Keys for boolean columns of ‘.var’ which identify variables you could want to control for: _mito</p></li>
</ul>
</li>
<li><p><em>Configure Output: ‘anndata_out’:</em></p>
<ul>
<li><p><em>Label:</em> Chequeo: Archivo – filt – mito - QC.</p></li>
<li><p>_Rename dataset: _Archivo – filt – mito - QC.</p></li>
</ul>
</li>
</ul>
</section>
<section id="grafico-metricas-generales-de-qc">
<h2>20: Gráfico: Métricas generales de QC<a class="headerlink" href="#grafico-metricas-generales-de-qc" title="Link to this heading">#</a></h2>
<p>Este módulo generará tres gráficos que indican diferentes métricas de calidad:</p>
<ul class="simple">
<li><p>El panel ‘n_genes_by_counts’ indica el número de genes expresados por célula.</p></li>
<li><p>El panel ‘total_counts’ indica el número de cuentas por célula (tamaño de célula).</p></li>
<li><p>El panel ‘pct_counts_mito’ indica el porcentaje de genes mitocondriales expresados en cada célula</p></li>
</ul>
<p>Utilizar la herramienta “<strong>Plot with Scanpy”</strong> con los siguientes ajustes:</p>
<ul class="simple">
<li><p>_Data input: _’adata’ (h5ad) (no manipulable en Flujo de Trabajo; corresponde al Archivo – filt – mito - QC).</p></li>
<li><p><em>Format for saving figures:</em> png</p></li>
<li><p><em>Method used for plotting:</em> Generic: Violin plot, using ‘pl.violin’</p>
<ul>
<li><p><em>Keys for accessing variables:</em>  	Subset of variables in ‘adata.var_names’ or fields of ‘.obs’</p>
<ul>
<li><p><em>Keys for accessing variables:</em> total_counts, n_genes_by_counts, pct_counts_mito</p></li>
</ul>
</li>
</ul>
</li>
<li><p><em>Violin plot attributes</em></p>
<ul>
<li><p>_Display keys in multiple panels: _Yes <strong>(sólo aplica para cuándo no se está trabajando en el Flujo de Trabajo).</strong></p></li>
</ul>
</li>
<li><p><em>Configure Output: ‘out_png’:</em></p>
<ul>
<li><p><em>Label:</em> Chequeo: Métricas generales de QC.</p></li>
<li><p>_Rename dataset: _Métricas generales de QC.</p></li>
</ul>
</li>
</ul>
</section>
<section id="grafico-numero-de-genes-expresados-y-la-proporcion-de-genes-mitocondriales">
<h2>21: Gráfico: Número de genes expresados y la proporción de genes mitocondriales<a class="headerlink" href="#grafico-numero-de-genes-expresados-y-la-proporcion-de-genes-mitocondriales" title="Link to this heading">#</a></h2>
<p>Indica la abundancia de genes expresados (eje x) y la proporción (%) de genes mitocondriales entre dichos genes (eje y). Este parámetro sirve para evaluar cuántos genes expresados se considerarán para los siguientes análisis, seleccionando un threshold de al menos N genes expresados. N se selecciona en función de la proporción de genes mitocondriales expresados, por ejemplo, las poblaciones de células que expresan 2000 genes y poseen en promedio un 5% de genes mitocondriales, podrían considerarse ruido por dos razones, poca cantidad de genes expresados, y un alto porcentaje de genes mitocondriales expresados.</p>
<p>Utilizar la herramienta “<strong>Plot with Scanpy”</strong> con los siguientes ajustes:</p>
<ul class="simple">
<li><p>_Data input: _’adata’ (h5ad) (no manipulable en Flujo de Trabajo; corresponde al Archivo – filt – mito - QC).</p></li>
<li><p><em>Format for saving figures:</em> png</p></li>
<li><p><em>Method used for plotting:</em> Generic: Scatter plot along observations or variables axes, using ‘pl.scatter’</p>
<ul>
<li><p>_Plotting tool that computed coordinates: _Using coordinates</p>
<ul>
<li><p>_x coordinate: _total_counts</p></li>
<li><p>_y coordinate: _pct_counts_mito</p></li>
<li><p><em>Use the layers attribute?: No</em></p></li>
</ul>
</li>
</ul>
</li>
<li><p><em>Configure Output: ‘out_png’:</em></p>
<ul>
<li><p><em>Label:</em> Chequeo: Genes expresados vs porcentaje de genes mitocondriales.</p></li>
<li><p>_Rename dataset: _Genes expresados vs porcentaje de genes mitocondriales.</p></li>
</ul>
</li>
</ul>
</section>
<section id="grafico-numero-de-genes-expresados-por-celula-y-total-de-genes-expresados">
<h2>22: Gráfico: Número de genes expresados por célula y total de genes expresados<a class="headerlink" href="#grafico-numero-de-genes-expresados-por-celula-y-total-de-genes-expresados" title="Link to this heading">#</a></h2>
<p>Relación entre el número total de cuentas para una célula (eje x), y el número de genes con cuentas positivas (eje y).</p>
<p>Este gráfico indica si existe una correlación entre las lecturas de cada célula y la cantidad de genes expresados encontrados en dichas lecturas.</p>
<p>Utilizar la herramienta “<strong>Plot with Scanpy”</strong> con los siguientes ajustes:</p>
<ul class="simple">
<li><p>_Data input: _’adata’ (h5ad) (no manipulable en Flujo de Trabajo; corresponde al Archivo – filt – mito - QC).</p></li>
<li><p><em>Format for saving figures:</em> png</p></li>
<li><p><em>Method used for plotting:</em> Generic: Scatter plot along observations or variables axes, using ‘pl.scatter’</p>
<ul>
<li><p>_Plotting tool that computed coordinates: _Using coordinates</p>
<ul>
<li><p>_x coordinate: _total_counts</p></li>
<li><p>_y coordinate: _n_genes_by_counts</p></li>
<li><p><em>Use the layers attribute?: No</em></p></li>
</ul>
</li>
</ul>
</li>
<li><p><em>Configure Output: ‘out_png’:</em></p>
<ul>
<li><p><em>Label:</em> Chequeo: Genes expresados por célula vs total de genes expresados.</p></li>
<li><p>_Rename dataset: _Genes expresados por célula vs total de genes expresados.</p></li>
</ul>
</li>
</ul>
</section>
<section id="filtro-eliminar-celulas-con-pocos-genes-expresados">
<h2>23: Filtro: Eliminar células con pocos genes expresados<a class="headerlink" href="#filtro-eliminar-celulas-con-pocos-genes-expresados" title="Link to this heading">#</a></h2>
<p>*A contar de este paso, el output no se ocupará la opción <em>Configure Output</em> hasta el paso 25, ya que se aplicarán varios filtros sucesivos. Cabe destacar que en el Flujo de Trabajo, estos filtros son secuenciales, utilizando como input el output del filtro anterior, y en el caso de no usar el Flujo de Trabajo y trabajar en Galaxy únicamente con la interfaz de módulos, se debe seleccionar el input manualmente, teniendo cuidado de no perder el rastro del input y output correctos.</p>
<p>Basado en los gráficos 20-22, se proceden a escoger los valores de los threshold para filtrar células de baja calidad. Dado a los resultados en el gráfico 20, panel ‘n_genes_by_counts’, se establece que no se considerarán las células que posean menos de 200 genes expresados.</p>
<p>Utilizar la herramienta <strong>“Filter with Scanpy”</strong> con los siguientes ajustes:</p>
<ul class="simple">
<li><p>_Data input: _’adata’ (h5ad) (no manipulable en Flujo de Trabajo; corresponde al Archivo – filt – mito - QC).</p></li>
<li><p><em>Method used for filtering:</em> Filter cell outliers based on counts and numbers of genes expressed, using ‘pp.filter_cells’</p>
<ul>
<li><p>_Filter: _Minimum number of genes expressed</p></li>
<li><p>_Minimum number of genes expressed required for a cell to pass filtering: _200</p></li>
</ul>
</li>
</ul>
</section>
<section id="filtro-eliminar-celulas-con-demasiados-genes-expresados">
<h2>24: Filtro: Eliminar células con demasiados genes expresados<a class="headerlink" href="#filtro-eliminar-celulas-con-demasiados-genes-expresados" title="Link to this heading">#</a></h2>
<p>Dado a los resultados en el gráfico 20, panel ‘n_genes_by_counts’, se establece que no se considerarán las células que posean menos de 2,500 genes expresados.</p>
<p>Utilizar la herramienta <strong>“Filter with Scanpy”</strong> con los siguientes ajustes:</p>
<ul class="simple">
<li><p>_Data input: _’adata’ (h5ad) (no manipulable en Flujo de Trabajo; corresponde al output del paso 23).</p></li>
<li><p><em>Method used for filtering:</em> Filter cell outliers based on counts and numbers of genes expressed, using ‘pp.filter_cells’</p>
<ul>
<li><p>_Filter: _Maximum number of genes expressed</p></li>
<li><p>_Minimum number of genes expressed required for a cell to pass filtering: _2500</p></li>
</ul>
</li>
</ul>
</section>
<section id="filtro-eliminar-celulas-con-gran-porcentaje-de-expresion-de-genes-mitocondriales">
<h2>25: Filtro: Eliminar células con gran porcentaje de expresión de genes mitocondriales<a class="headerlink" href="#filtro-eliminar-celulas-con-gran-porcentaje-de-expresion-de-genes-mitocondriales" title="Link to this heading">#</a></h2>
<p>Dado los resultados en el gráfico 20 ‘pct_counts_mito’, se establece que no se considerarán células con más de un 5% de genes mitocondriales expresados con respecto al total de genes expresados de la misma célula.</p>
<p>Utilizar la herramienta <strong>“Manipulate AnnData object”</strong> con los siguientes ajustes:</p>
<ul class="simple">
<li><p>_Data input: _’adata’ (h5ad) (no manipulable en Flujo de Trabajo; corresponde al output del paso 24).</p></li>
<li><p><em>Function to manipulate the object:</em> Filter observations or variables</p>
<ul>
<li><p><em>What to filter:</em> Observations (obs)</p>
<ul>
<li><p><em>Type of filtering?:</em> By key (column) values</p></li>
<li><p><em>Key to filter:</em> pct_counts_mito</p>
<ul>
<li><p><em>Type of value to filter</em>: Number</p></li>
<li><p><em>Filter:</em> less than</p></li>
<li><p><em>Value:</em> 5.0</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p><em>Configure Output: ‘Anndata’:</em></p>
<ul>
<li><p><em>Label:</em> Archivo – QC_filt.</p></li>
<li><p>_Rename dataset: _Archivo – QC_filt.</p></li>
</ul>
</li>
</ul>
</section>
<section id="normalizacion">
<h2>26: Normalización<a class="headerlink" href="#normalizacion" title="Link to this heading">#</a></h2>
<p>Los datos deben ser normalizados para que cada célula de la muestra sea comparable entre sí, eliminando la variabilidad del set de datos producto de diferencias durante la síntesis de cDNA y amplificación por PCR.</p>
<p>El método de normalización empleado en este pipeline es llamado Scaling, el cual asume que todos los sesgos que pudiesen haberse generado en los experimentos se aplican de forma similar a todas las células. Con este método las cuentas de genes de cada célula son divididas por un factor de escalado (scaling) específico para cada célula, llamado factor de tamaño (size factor). El factor de tamaño de cada célula es computado directamente desde el tamaño de la célula (cantidad de reads asignados a dicha célula), y es transformado para que el tamaño promedio del factor entre todas las células sea igual a 1.</p>
<p>Con este método, los valores de expresión obtenidos mantendrían la proporción de expresión de genes, generando un set de datos que permite comparar a cada célula entre sí.</p>
<p>Utilizar la herramienta <strong>“Normalize with scanpy”</strong> con los siguientes ajustes:</p>
<ul class="simple">
<li><p>_Data input: _’adata’ (h5ad) (no manipulable en Flujo de Trabajo; corresponde al Archivo – QC_filt).</p></li>
<li><p><em>Method used for normalization:</em> Normalize counts per cell, using ‘pp.normalize_total’</p>
<ul>
<li><p><em>Target sum:</em> 10000.0</p></li>
<li><p><em>Exclude (very) highly expressed genes for the computation of the normalization factor (size factor) for each cell:</em> No</p></li>
<li><p><em>Name of the field in ‘adata.obs’</em> where the normalization factor is stored: norm</p></li>
<li><p>_List of layers to normalize: _all</p></li>
<li><p><em>How to normalize layers?:</em> After: for each layer in layers each cell has a total count equal to target_sum.</p></li>
</ul>
</li>
<li><p><em>Configure Output: ‘Anndata’:</em></p>
<ul>
<li><p><em>Label:</em> Archivo – QC_filt – normalizado.</p></li>
<li><p>_Rename dataset: _Archivo – QC_filt – normalizado.</p></li>
</ul>
</li>
</ul>
</section>
<section id="transformacion-logaritmica">
<h2>27: Transformación logaritmica<a class="headerlink" href="#transformacion-logaritmica" title="Link to this heading">#</a></h2>
<p>Esta transformación a los valores normalizados los hace análogos a un log(veces de cambio; ‘log(FoldChange)’).</p>
<p>Utilizar la herramienta <strong>“Inspect and manipulate with scanpy”</strong> con los siguientes ajustes:</p>
<ul class="simple">
<li><p>_Data input: _’adata’ (h5ad) (no manipulable en Flujo de Trabajo; corresponde al Archivo – QC_filt – normalizado).</p></li>
<li><p><em>Method used for inspecting:</em> Logarithmize the data matrix, using ‘pp.log1p’</p></li>
<li><p><em>Configure Output: ‘Anndata’:</em></p>
<ul>
<li><p><em>Label:</em> Archivo – QC_filt – norm - FC.</p></li>
<li><p>_Rename dataset: _Archivo – QC_filt – norm - FC.</p></li>
</ul>
</li>
</ul>
</section>
<section id="bloquear-estado-del-archivo-anndata">
<h2>28: Bloquear estado del archivo Anndata<a class="headerlink" href="#bloquear-estado-del-archivo-anndata" title="Link to this heading">#</a></h2>
<p>En este paso se bloqueará el archivo que hemos trabajado hasta el paso previo, el cual está en formato Anndata, para usarlo en análisis posteriores.</p>
<p>Utilizar la herramienta <strong>“Inspect and manipulate with scanpy”</strong> con los siguientes ajustes:</p>
<ul class="simple">
<li><p>_Data input: _’input’ (h5ad) (no manipulable en Flujo de Trabajo; corresponde al Archivo – QC_filt – norm - FC).</p></li>
<li><p><em>Method used for inspecting:</em> Logarithmize the data matrix, using ‘pp.log1p’</p></li>
<li><p><em>Configure Output: ‘Anndata’:</em></p>
<ul>
<li><p><em>Label:</em> Archivo – QC – norm.</p></li>
<li><p>_Rename dataset: _Archivo – QC – norm.</p></li>
</ul>
</li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="preprocesamiento.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Preprocesamiento</p>
      </div>
    </a>
    <a class="right-next"
       href="caracteristicas.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Selección de características</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inspeccion-de-control-de-calidad">11: Inspección de control de calidad</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#anotacion-de-genes-mitocondriales-extraccion-de-genes-presentes-en-el-set-de-datos">12: Anotación de genes mitocondriales: Extracción de genes presentes en el set de datos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#chequeo-de-formato-de-anotacion-de-genes">13: Chequeo de formato de anotación de genes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#formatear-texto-para-detectar-genes-mitocondriales">14: Formatear texto para detectar genes mitocondriales</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cambio-de-formato-de-binario-a-v-f">15: Cambio de formato de binario a V/F</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#concatenar-header-y-clasificacion-de-genes-mitocondriales">16: Concatenar header y clasificación de genes mitocondriales</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#anadir-anotacion-mitocondrial-a-archivo-filtrado">17: Añadir anotación mitocondrial a Archivo filtrado</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inspeccionar-integracion-de-la-anotacion-mitocondrial">18: Inspeccionar integración de la anotación mitocondrial</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#computo-de-metricas-de-control-de-calidad-qc">19: Cómputo de métricas de control de calidad (QC)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#grafico-metricas-generales-de-qc">20: Gráfico: Métricas generales de QC</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#grafico-numero-de-genes-expresados-y-la-proporcion-de-genes-mitocondriales">21: Gráfico: Número de genes expresados y la proporción de genes mitocondriales</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#grafico-numero-de-genes-expresados-por-celula-y-total-de-genes-expresados">22: Gráfico: Número de genes expresados por célula y total de genes expresados</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filtro-eliminar-celulas-con-pocos-genes-expresados">23: Filtro: Eliminar células con pocos genes expresados</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filtro-eliminar-celulas-con-demasiados-genes-expresados">24: Filtro: Eliminar células con demasiados genes expresados</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filtro-eliminar-celulas-con-gran-porcentaje-de-expresion-de-genes-mitocondriales">25: Filtro: Eliminar células con gran porcentaje de expresión de genes mitocondriales</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#normalizacion">26: Normalización</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#transformacion-logaritmica">27: Transformación logaritmica</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bloquear-estado-del-archivo-anndata">28: Bloquear estado del archivo Anndata</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By LatinCells
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>